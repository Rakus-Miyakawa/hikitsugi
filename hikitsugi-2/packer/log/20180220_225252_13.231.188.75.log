date
Tue Feb 20 13:52:56 UTC 2018
[ec2-user@ip-172-31-19-138 ~]$ ll /opt/
total 4
drwxr-xr-x 5 root root 4096 Jan 15 18:43 aws
[ec2-user@ip-172-31-19-138 ~]$ sudo su ^-
[root@ip-172-31-19-138 ~]# wget  https://releases.hashicorp.com/packer/0.10.1/packer_0.10.1_linux_am d64.zip
--2018-02-20 14:21:28--  https://releases.hashicorp.com/packer/0.10.1/packer_0.10.1_linux_amd64.zip
Resolving releases.hashicorp.com (releases.hashicorp.com)... 151.101.73.183, 2a04:4e42:11::439
Connecting to releases.hashicorp.com (releases.hashicorp.com)|151.101.73.183|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 8985735 (8.6M) [application/zip]
Saving to: epacker_0.10.1_linux_amd64.zipf

packer_0.10.1_linux_amd6   0%[                                   ]       0  --.-KB/s               packer_0.10.1_linux_amd6  38%[============>                      ]   3.26M  16.3MB/s               packer_0.10.1_linux_amd6  98%[=================================> ]   8.46M  21.1MB/s               packer_0.10.1_linux_amd6 100%[==================================>]   8.57M  21.2MB/s    in 0.4s    

2018-02-20 14:21:29 (21.2 MB/s) - epacker_0.10.1_linux_amd64.zipf saved [8985735/8985735]

[root@ip-172-31-19-138 ~]# [root@ip-172-31-19-138 ~]# unzip packer_0.10.1_linux_amd64.zip -d /opt/packer/
Archive:  packer_0.10.1_linux_amd64.zip
  inflating: /opt/packer/packer      
[root@ip-172-31-19-138 ~]# ll -/opt/packer/packer 
-rwxr-xr-x 1 root root 42339000 May  7  2016 /opt/packer/packer
[root@ip-172-31-19-138 ~]# ll /opt/packer/packer 
total 41348
-rwxr-xr-x 1 root root 42339000 May  7  2016 packer
[root@ip-172-31-19-138 ~]# man packerless /opt/lpacker/packer 
"/opt/packer/packer" may be a binary file.  See it anyway? 
[root@ip-172-31-19-138 ~]# export PATH=/opt/packer:$PATH
[root@ip-172-31-19-138 ~]# echo 'export PATH=/opt/packer:$PATH' >> ~/.bashrc
[root@ip-172-31-19-138 ~]# packer version
Packer v0.10.1

Your version of Packer is out of date! The latest version
is 1.2.0. You can update by downloading from www.packer.io
[root@ip-172-31-19-138 ~]# ced  cd /olipt/lipacker/
[root@ip-172-31-19-138 packer]# ll
total 41348
-rwxr-xr-x 1 root root 42339000 May  7  2016 packer
[root@ip-172-31-19-138 packer]# L[root@ip-172-31-19-138 packer]# vi /opt/packer/hikitsugi2.json
"/opt/packer/hikitsugi2.json" [New File]~                                                                                                   ~                                                                                                   ~                                                                                                   ~                                                                                                   ~                                                                                                   ~                                                                                                   ~                                                                                                   ~                                                                                                   ~                                                                                                   ~                                                                                                   ~                                                                                                   ~                                                                                                   ~                                                                                                   ~                                                                                                   ~                                                                                                   ~                                                                                                   ~                                                                                                   ~                                                                                                   ~                                                                                                   ~                                                                                                   ~                                                                                                   ~                                                                                                   ~                                                                                                   -- INSERT --{    "builders":    [{"type": "amazon-ebs","access_key": "AKIAJUKXTNENIJIOEHFA","secret_key": "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","ami_name": "hikitsugi2","region": "ap-northeast-1","source_ami": "ami-ceafcba8","instance_type": "t2.micro","ssh_username": "ec2-user"}    ],    "provisioners": [{"type": "shell","inline": [ "echo hello world" ]}    ]}:wq"hikitsugi2.json" [New] 21L, 529C written
[root@ip-172-31-19-138 packer]# packer validate hikitsugi2.json
Template validated successfully.
[root@ip-172-31-19-138 packer]# packer build hikitsugi2.json
amazon-ebs output will be in this color.

==> amazon-ebs: Prevalidating AMI Name...
==> amazon-ebs: Inspecting the source AMI...
==> amazon-ebs: Creating temporary keypair: packer 5a8c2fb7-5a30-99aa-6bd9-49acb8ace3f0
==> amazon-ebs: Creating temporary security group for this instance...
==> amazon-ebs: Authorizing access to port 22 the temporary security group...
==> amazon-ebs: Launching a source AWS instance...
    amazon-ebs: Instance ID: i-04a8c7e12105f9575
==> amazon-ebs: Waiting for instance (i-04a8c7e12105f9575) to become ready...
==> amazon-ebs: Waiting for SSH to become available...
==> amazon-ebs: Connected to SSH!
==> amazon-ebs: Provisioning with shell script: /tmp/packer-shell887770770
    amazon-ebs: hello world
==> amazon-ebs: Stopping the source instance...
==> amazon-ebs: Waiting for the instance to stop...
==> amazon-ebs: Creating the AMI: hikitsugi2
    amazon-ebs: AMI: ami-c2631ba4
==> amazon-ebs: Waiting for AMI to become ready...
==> amazon-ebs: Terminating the source AWS instance...
==> amazon-ebs: Cleaning up any extra volumes...
==> amazon-ebs: No volumes to clean up, skipping
==> amazon-ebs: Deleting temporary security group...
==> amazon-ebs: Deleting temporary keypair...
Build 'amazon-ebs' finished.

==> Builds finished. The artifacts of successful builds are:
--> amazon-ebs: AMIs were created:

ap-northeast-1: ami-c2631ba4
[root@ip-172-31-19-138 packer]# exit
logout
[ec2-user@ip-172-31-19-138 ~]$ exit
logout
